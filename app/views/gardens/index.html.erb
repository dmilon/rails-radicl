<%= render 'shared/banner-community' %>

<div class="container map">

  <div class="wrapper wrapper-3 animated fadeInUp">
    <h1 class="how text-center">join and share with your community</h1>
</div>

<div class="tab animated fadeInUp">
    <button class="tablinks default" data-tab="Follow"><h1>join them</h1></button>
    <button class="tablinks" data-tab="Shared"><h1>shared with you</h1></button>
</div>


<div id="Follow" class="tabcontent active animated fadeInUp">
  <div class="row zones-garden">
    <div class="col-xs-12 col-md-6">
    <div id= "search-community">
      <%= form_tag community_gardens_path, method: :get do %>
        <%= text_field_tag :query, params[:query], class: "barwidth", placeholder: "search for a farm, build your community" %>
      <% end %>
    </div>
    <br><br>
    <div
      id="map"
      style="min-width: 500px; min-height: 600px;"
      data-markers="<%= @markers.to_json %>">
    </div>
    </div>


<div class="col-xs-12 col-md-6">
  <% @gardens.each do |garden| %>
    <% follow = current_user.follow?(garden) %>
    <div class="col-xs-12 col-sm-6">
      <div class="card">
        <%= cl_image_tag garden.photo, class: "card-img-top" %>
        <%= link_to follows_path(garden_id: garden.id), method: :post, class: "icon" do %>
          <i class="fas fa-heart <%= "followed" if follow %>" ></i>
        <% end %>
         <!--  <a href="#" class="icon"><i class="fas fa-seedling"></i></a> -->
        <%= link_to garden_path(garden) do %>
          <div class="overlay">
            <div class="text">
              <h2><%= garden.name %></h2>
              <p><%= garden.address %></p>
            </div>
          </div>

        </div>
          <div class="card-link">
            <p>discover</p>
          </div>
        <% end %>
    </div>
<% end %>
</div>
    </div>
  </div>


<!-- this is the shared section -->
<div id="Shared" class="tabcontent">
  <div class="row garden-logs">
    <%# if @garden.zones == [] %>
    <%# else %>

      <div id= "searchbar">
          <%= text_field_tag :query,
            params[:query],
            class: "barwidth",
            placeholder: "search for shared products"%>
            <i class="far fa-times-circle"></i>
        <div class= "filter">
          <div id="myBtnContainer">
            <button class="btn active btn-lg btn-home filter-btn" data-filter="all"> Show all</button>
            <button class="btn filter-btn" data-filter="category">Category</button>
            <button class="btn filter-btn" data-filter="date">Date</button>
            <button class="btn filter-btn" data-filter="date">Availability</button>
          </div>
        </div>
      </div>

    <% @products.each do |product| %>
      <% @users.each do |user| %>
        <% if user.garden == product.element.zone.garden  %>
          <div class="message">
            <div class="message-name">
              <%= cl_image_tag user.garden.photo, class: "avatar-large shared"  %>
            </div>
            <div class="message-body product">
              <p><strong><%= product.element.name.upcase %> x <%= product.quantity %></strong></p>
            </div>
            <div class="message-body">
              <p><%= user.name %></p>
            </div>
            <div class="message-body">
                <% if product.end_date > Date.today %>
                  <img src="https://res.cloudinary.com/bdmbdm/image/upload/v1528132671/goFichier_1_4x-100.jpg" width= 20>
                <% else %>
                  <img src="https://res.cloudinary.com/bdmbdm/image/upload/v1528132671/foFichier_1_4x-100.jpg" width= 20>
                <% end %>
            </div>
            <div class="message-body">
              <h6><%= user.garden.name.upcase %></h6>
              <p><%= user.garden.address %></p>
            </div>
              <div class="message-body">
                <button class="button-contact sweet-1" data-toggle="modal" data-target="#myModal-message"> CONTACT </button>
              </div>
          </div>
        <% end %>
      <% end %>
    <% end %>
  </div>
</div>
  <!-- this is the end of log section -->
<br><br>

<!-- <div>
  <h1>Followed</h1>
  <#% current_user.follows.each do |follow| %>
  <p><%#= follow.garden.name %></p>
  <%# end %>
</div>
 -->
<div class="modal fade" id="myModal-message" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content form">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">send a message</h4>
      </div>
      <div class="modal-body">
        <div class="form-actions">
          <form action="#" method="get">
            <div>
              <br>
              <label for="name">your name:</label>
              <input type="text" id="name" name="user_name" class="form-control">
            </div>
            <div>
              <br>
              <label for="msg">your message:</label>
              <textarea id="msg" name="user_message" class="form-control msg"></textarea>
            </div>
            <div>
              <input type="submit" value="contact the farmer" class="btn btn-home btn-lg" onclick="confirmSent()">
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

</div>
